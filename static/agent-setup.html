<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Setup - BhashAI</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #6366f1;
            --secondary: #8b5cf6;
            --accent: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f8fafc;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(-45deg, #667eea, #764ba2, #f093fb, #f5576c);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            z-index: -1;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .sidebar {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            width: 280px;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            min-height: 100vh;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .main-content {
            flex: 1;
            background: transparent;
        }
        .tab-button {
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            margin-right: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .tab-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
            transition: left 0.5s;
        }
        .tab-button:hover::before {
            left: 100%;
        }
        .tab-button.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: var(--primary);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }
        .tab-button:hover {
            background: rgba(99, 102, 241, 0.1);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .tab-button.active:hover {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }
        .prompt-textarea {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            padding: 16px;
            width: 100%;
            min-height: 120px;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 500;
            resize: vertical;
            transition: all 0.3s ease;
        }
        .prompt-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
            transform: translateY(-2px);
        }
        .agent-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .agent-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
            transition: left 0.5s;
        }
        .agent-card:hover::before {
            left: 100%;
        }
        .agent-card:hover {
            border-color: var(--primary);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.15);
            transform: translateY(-4px);
        }
        .agent-card.active {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.2);
        }
        .cost-indicator {
            display: inline-flex;
            align-items: center;
            font-size: 12px;
            color: #6b7280;
        }
        .cost-bar {
            width: 60px;
            height: 4px;
            border-radius: 2px;
            margin-left: 8px;
            overflow: hidden;
        }
        
        /* Enhanced slider styles */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
            cursor: pointer;
        }
        
        input[type="range"]::-webkit-slider-track {
            background: #e5e7eb;
            height: 6px;
            border-radius: 3px;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            height: 20px;
            width: 20px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 4px 8px rgba(99, 102, 241, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(99, 102, 241, 0.4);
        }
        
        input[type="range"]::-moz-range-track {
            background: #e5e7eb;
            height: 6px;
            border-radius: 3px;
            border: none;
        }
        
        input[type="range"]::-moz-range-thumb {
            background: #3b82f6;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        
        /* Blue slider track for termination slider */
        #terminationTimeSlider::-webkit-slider-track {
            background: linear-gradient(to right, #3b82f6 0%, #3b82f6 50%, #e5e7eb 50%, #e5e7eb 100%);
        }
        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            border-radius: 12px;
            margin: 4px 8px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        .nav-item:hover::before {
            left: 100%;
        }
        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateX(5px);
        }
        .nav-item.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-weight: 600;
            border-left: 4px solid #fff;
        }
        .nav-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
        }
        
        /* Custom slider styling */
        .slider {
            background: #e5e7eb;
            outline: none;
            border-radius: 8px;
            height: 6px;
        }
        
        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .faq-block {
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
        }
        
        .faq-block:hover {
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.15);
            transform: translateY(-2px);
            border-color: var(--primary);
        }

        .glassmorphism {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border-radius: 24px;
        }

        .content-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 24px;
            margin-bottom: 24px;
            transition: all 0.3s ease;
        }

        .content-section:hover {
            box-shadow: 0 15px 35px rgba(99, 102, 241, 0.1);
        }

        .header-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            color: white;
            font-weight: 700;
            font-size: 1.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .section-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }

        /* Button improvements */
        .btn {
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background: rgba(99, 102, 241, 0.1);
            border-color: var(--primary);
            transform: translateY(-1px);
        }

        /* Input field improvements */
        input, select {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        input:focus, select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
            transform: translateY(-1px);
        }

        /* Logo enhancement */
        .logo-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 16px;
            animation: float 3s ease-in-out infinite;
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
    </style>
</head>
<body>
    <div class="flex">
        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Header -->
            <div class="p-6 header-section">
                <div class="flex items-center">
                    <div class="w-10 h-10 logo-icon flex items-center justify-center mr-3">
                        <i class="fas fa-microphone-alt text-white"></i>
                    </div>
                    <div>
                        <div class="font-bold text-white text-lg">BhashAI</div>
                        <div class="text-sm text-green-300 flex items-center">
                            <div class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></div>
                            Active
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="p-2">
                <div class="text-xs font-medium text-white opacity-60 uppercase tracking-wide px-3 py-2">Platform</div>
                
                <a href="/dashboard.html" class="nav-item">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5v6h8V5"></path>
                    </svg>
                    Dashboard
                </a>
                
                <a href="#" onclick="goBackToChannel()" class="nav-item">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18"></path>
                    </svg>
                    Back to Channel
                </a>
                
                <a href="#" class="nav-item active">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    Agent Setup
                </a>
                
                <a href="#" class="nav-item">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                    </svg>
                    Call History
                </a>
                
                <a href="#" class="nav-item">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path>
                    </svg>
                    My numbers
                </a>
                
                <a href="#" class="nav-item">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                    </svg>
                    Knowledge Base
                </a>
                
                <a href="#" class="nav-item">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    Batches
                </a>
                
                <a href="#" class="nav-item">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                    </svg>
                    Voice Lab
                </a>
                
                <a href="#" class="nav-item">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                    </svg>
                    Developers
                </a>
                
                <a href="#" class="nav-item">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    Providers
                </a>
            </div>

            <!-- Agents Section -->
            <div class="p-4 border-t border-white border-opacity-20">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="font-semibold text-white">Your Agents</h3>
                    <div class="flex space-x-2">
                        <button onclick="addAgent()" class="text-white hover:text-blue-300 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                        </button>
                        <button class="text-white opacity-70 hover:opacity-100 transition-opacity">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Agent List -->
                <div class="space-y-2">
                    <div class="agent-card active" onclick="selectAgent(this, 'reminder')">
                        <div class="font-medium text-sm">Reminder call to patients after 5 days</div>
                    </div>
                    
                    <div class="agent-card" onclick="selectAgent(this, 'ayushman')">
                        <div class="font-medium text-sm">AYUSHMAN final OPD REGISTRATION V2 MEDICAL</div>
                    </div>
                    
                    <div class="agent-card" onclick="selectAgent(this, 'doctor')">
                        <div class="font-medium text-sm">Doctor reminder for marketing final</div>
                    </div>
                    
                    <div class="agent-card" onclick="selectAgent(this, 'dubai')">
                        <div class="font-medium text-sm">Dubai indian final Manzil AI Voice Concierge</div>
                    </div>
                    
                    <div class="agent-card" onclick="selectAgent(this, 'opd')">
                        <div class="font-medium text-sm">OPD on discharge.final</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Breadcrumb -->
            <div class="bg-gray-50 px-4 py-3 border-b border-gray-200">
                <nav class="flex items-center text-sm text-gray-500">
                    <a href="/dashboard.html" class="text-blue-600 hover:text-blue-800">Dashboard</a>
                    <span class="mx-2">›</span>
                    <a href="#" onclick="goBackToOrg()" class="text-blue-600 hover:text-blue-800" id="orgBreadcrumb">Main Hospital</a>
                    <span class="mx-2">›</span>
                    <a href="#" onclick="goBackToChannel()" class="text-blue-600 hover:text-blue-800" id="channelBreadcrumb">Inbound Calls</a>
                    <span class="mx-2">›</span>
                    <span class="text-gray-900 font-medium" id="agentBreadcrumb">Agent Setup</span>
                </nav>
            </div>
            
            <!-- Header -->
            <div class="glassmorphism m-6 p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="section-title">Agent Setup</h1>
                        <p class="section-subtitle">Fine tune your agents</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="text-sm text-white bg-white bg-opacity-20 px-3 py-2 rounded-lg backdrop-filter backdrop-blur-sm">
                            Available balance: <span class="font-semibold">₹346.50</span>
                        </div>
                        <button class="btn btn-secondary text-sm px-4 py-2">Add more funds</button>
                        <button class="btn btn-secondary text-sm px-4 py-2">See demo →</button>
                        <button class="btn btn-secondary text-sm px-4 py-2">Docs ↗</button>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Main Panel -->
                    <div class="lg:col-span-2">
                        <div class="content-section p-6">
                            <!-- Agent Header -->
                            <div class="mb-6 pb-4 border-b border-white border-opacity-20">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h2 class="text-xl font-bold text-gray-800" id="agentTitle">Reminder call to patients after 5 days</h2>
                                        <div class="mt-2">
                                            <span class="bg-white bg-opacity-60 text-gray-700 text-xs px-3 py-1 rounded-full font-mono" id="agentId">004686a4-184a-44f0-a765-c91896153e5a</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-3">
                                        <button class="btn btn-secondary p-2">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
                                            </svg>
                                        </button>
                                        <span class="text-sm text-gray-600 font-medium">Share</span>
                                    </div>
                                </div>
                                
                                <!-- Language & Voice Selector -->
                                <div class="flex items-center mt-3 space-x-4">
                                    <div class="flex items-center space-x-2">
                                        <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path>
                                        </svg>
                                        <select class="border border-gray-300 rounded px-2 py-1 text-sm">
                                            <option>English (United States)</option>
                                            <option>Hindi (India)</option>
                                            <option>Hinglish</option>
                                        </select>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <select class="border border-gray-300 rounded px-2 py-1 text-sm">
                                            <option>Kajal</option>
                                            <option>Arjun</option>
                                            <option>Priya</option>
                                            <option>Rohan</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Cost Indicator -->
                                <div class="flex items-center mt-3 text-sm">
                                    <span class="text-gray-600">~₹0.04/min</span>
                                    <span class="text-xs text-gray-500 ml-2">(excl. telephony)</span>
                                    <div class="ml-4 flex items-center space-x-3">
                                        <div class="cost-indicator">
                                            Transcriber
                                            <div class="cost-bar bg-gray-200"><div class="h-full bg-green-500" style="width: 5%"></div></div>
                                            <span class="ml-2">0.006</span>
                                        </div>
                                        <div class="cost-indicator">
                                            LLM
                                            <div class="cost-bar bg-gray-200"><div class="h-full bg-orange-500" style="width: 15%"></div></div>
                                            <span class="ml-2">0.009</span>
                                        </div>
                                        <div class="cost-indicator">
                                            Voice
                                            <div class="cost-bar bg-gray-200"><div class="h-full bg-blue-500" style="width: 10%"></div></div>
                                            <span class="ml-2">0.006</span>
                                        </div>
                                        <div class="cost-indicator">
                                            Platform
                                            <div class="cost-bar bg-gray-200"><div class="h-full bg-purple-500" style="width: 30%"></div></div>
                                            <span class="ml-2">0.02</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Configuration Tabs -->
                            <div class="p-4">
                                <div class="flex flex-wrap mb-6">
                                    <div class="tab-button active" onclick="showTab('agent')">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                        </svg>
                                        Agent
                                    </div>
                                    <div class="tab-button" onclick="showTab('llm')">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                        </svg>
                                        LLM
                                    </div>
                                    <div class="tab-button" onclick="showTab('transcribe')">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                                        </svg>
                                        Transcriber
                                    </div>
                                    <div class="tab-button" onclick="showTab('voice')">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 14.142M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
                                        </svg>
                                        Voice
                                    </div>
                                    <div class="tab-button" onclick="showTab('call')">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                        </svg>
                                        Call
                                    </div>
                                    <div class="tab-button" onclick="showTab('tools')">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                        Tools
                                    </div>
                                    <div class="tab-button" onclick="showTab('analytics')">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                        </svg>
                                        Analytics
                                    </div>
                                    <div class="tab-button" onclick="showTab('inbound')">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18"></path>
                                        </svg>
                                        Inbound
                                    </div>
                                    <div class="tab-button" onclick="showTab('outbound')">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                        </svg>
                                        Outbound
                                    </div>
                                </div>

                                <!-- Agent Tab Content -->
                                <div id="agentTab" class="tab-content">
                                    <div class="space-y-6">
                                        <!-- Agent Welcome Message -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Agent Welcome Message</label>
                                            <textarea 
                                                class="prompt-textarea" 
                                                id="welcomeMessage"
                                                placeholder="नमस्ते मैं आयुष्मान हॉस्पिटल से Dr. Murli BK का AI सहायक बोल रहा हूँ — आप नगपुर के आयुष्मान हॉस्पिटल में मरीजों के लिए आए थे?"
                                            >नमस्ते मैं आयुष्मान हॉस्पिटल से Dr. Murli BK का AI सहायक बोल रहा हूँ — आप नगपुर के आयुष्मान हॉस्पिटल में मरीजों के लिए आए थे?</textarea>
                                            <p class="text-xs text-gray-500 mt-1">This will be the initial message from the agent. You can use variables here using {variable_name}</p>
                                        </div>

                                        <!-- Agent Prompt -->
                                        <div>
                                            <div class="flex items-center justify-between mb-2">
                                                <label class="block text-sm font-medium text-gray-700">Agent Prompt</label>
                                                <a href="#" class="text-blue-600 hover:text-blue-700 text-sm">Help me build my agent ↗</a>
                                            </div>
                                            <textarea 
                                                class="prompt-textarea" 
                                                id="agentPrompt"
                                                style="min-height: 150px;"
                                                placeholder="Do not repeat - namaste during conversation. Namaste will be only in welcome message"
                                            >Do not repeat - namaste during conversation. Namaste will be only in welcome message

"अगर आपके पास आधार कार्ड और राशन कार्ड है, तो आयुष्मान कार्ड न होने पर भी ICU, ऑपरेशन, या एडमिशन इलाज़ फ्री मे दे दिया जा सकता है।"</textarea>

                                            <!-- Voice Bot Prompt -->
                                            <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                                                <div class="flex items-start">
                                                    <svg class="w-5 h-5 text-blue-600 mt-0.5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                                    </svg>
                                                    <div>
                                                        <div class="font-medium text-blue-900">Voice Bot Prompt to Engage:</div>
                                                        <textarea 
                                                            class="mt-2 w-full p-2 bg-white border border-blue-200 rounded text-sm"
                                                            rows="3"
                                                            placeholder="अब आप मुझसे अपनी स्वास्थ्य समस्या का जवाब दें देने के लिए हैं।"
                                                        >"अब आप मुझसे अपनी स्वास्थ्य समस्या का जवाब दें देने के लिए हैं।"</textarea>
                                                    </div>
                                                </div>
                                            </div>

                                            <p class="text-xs text-gray-500 mt-2">You can define variables in the prompt using {variable_name}</p>
                                        </div>

                                        <!-- Testing Variables -->
                                        <div>
                                            <h4 class="font-medium text-gray-900 mb-3">You can fill in your following prompt variables for testing</h4>
                                            <div class="bg-gray-50 rounded-lg p-4">
                                                <p class="text-sm text-gray-600">No variables defined yet. Add variables in your prompts using {variable_name} format.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- LLM Tab Content -->
                                <div id="llmTab" class="tab-content hidden">
                                    <div class="space-y-6">
                                        <h3 class="text-lg font-semibold text-gray-900">Choose LLM model</h3>
                                        
                                        <!-- LLM Model Selection -->
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">LLM Model</label>
                                                <select id="llmModel" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                    <option value="openai">Openai</option>
                                                    <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                                    <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                                    <option value="claude-3-sonnet">Claude-3 Sonnet</option>
                                                    <option value="claude-3-haiku">Claude-3 Haiku</option>
                                                    <option value="gemini-pro">Gemini Pro</option>
                                                </select>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Specific Model</label>
                                                <select id="specificModel" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                    <option value="gpt-4.1-mini">gpt-4.1-mini</option>
                                                    <option value="gpt-4-turbo">gpt-4-turbo</option>
                                                    <option value="gpt-3.5-turbo">gpt-3.5-turbo</option>
                                                    <option value="claude-3-sonnet-20240229">claude-3-sonnet-20240229</option>
                                                    <option value="claude-3-haiku-20240307">claude-3-haiku-20240307</option>
                                                    <option value="gemini-1.5-pro">gemini-1.5-pro</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- LLM Providers -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">LLM Providers</label>
                                            <div class="border border-gray-300 rounded-lg">
                                                <div class="flex items-center justify-between p-3 border-b border-gray-200">
                                                    <div class="flex items-center">
                                                        <span class="font-medium text-gray-900">Openai</span>
                                                        <svg class="w-5 h-5 text-green-500 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                                        </svg>
                                                    </div>
                                                    <button class="text-blue-600 hover:text-blue-800 text-sm">Configure</button>
                                                </div>
                                                <div class="flex items-center justify-between p-3 border-b border-gray-200">
                                                    <div class="flex items-center">
                                                        <span class="font-medium text-gray-900">Azure</span>
                                                        <span class="text-gray-400 ml-2 text-sm">(Not configured)</span>
                                                    </div>
                                                    <button class="text-blue-600 hover:text-blue-800 text-sm">Configure</button>
                                                </div>
                                                <div class="flex items-center justify-between p-3">
                                                    <div class="flex items-center">
                                                        <span class="font-medium text-gray-900">Deepseek</span>
                                                        <span class="text-gray-400 ml-2 text-sm">(Not configured)</span>
                                                    </div>
                                                    <button class="text-blue-600 hover:text-blue-800 text-sm">Configure</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Temperature Control -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Temperature</label>
                                            <div class="relative">
                                                <input type="range" id="temperatureSlider" min="0" max="1" step="0.1" value="0.2" 
                                                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                                    <span>0</span>
                                                    <span id="temperatureValue" class="font-medium text-blue-600">0.2</span>
                                                    <span>1</span>
                                                </div>
                                            </div>
                                            <p class="text-sm text-gray-600 mt-2">
                                                Increasing temperature enables heightened creativity, but increases chance of deviation from prompt
                                            </p>
                                        </div>

                                        <!-- Model Performance Info -->
                                        <div class="bg-blue-50 rounded-lg p-4">
                                            <h4 class="font-medium text-blue-900 mb-2">Model Performance</h4>
                                            <div class="grid grid-cols-3 gap-4 text-sm">
                                                <div>
                                                    <span class="text-blue-700">Latency:</span>
                                                    <span class="font-medium text-blue-900">~150ms</span>
                                                </div>
                                                <div>
                                                    <span class="text-blue-700">Cost:</span>
                                                    <span class="font-medium text-blue-900">₹0.009/min</span>
                                                </div>
                                                <div>
                                                    <span class="text-blue-700">Quality:</span>
                                                    <span class="font-medium text-blue-900">High</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Add FAQs & Guardrails -->
                                        <div>
                                            <div class="flex items-center justify-between mb-4">
                                                <h4 class="text-lg font-semibold text-gray-900">Add FAQs & Guardrails</h4>
                                                <a href="#" class="text-blue-600 hover:text-blue-800 text-sm">Learn more ↗</a>
                                            </div>
                                            
                                            <!-- FAQ Blocks -->
                                            <div id="faqBlocks" class="space-y-3 mb-4">
                                                <!-- Sample FAQ Block -->
                                                <div class="faq-block border border-gray-200 rounded-lg p-4">
                                                    <div class="flex items-start justify-between mb-3">
                                                        <h5 class="font-medium text-gray-900">Hospital Information FAQ</h5>
                                                        <button onclick="removeFaqBlock(this)" class="text-red-600 hover:text-red-800">
                                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                                            </svg>
                                                        </button>
                                                    </div>
                                                    <div class="space-y-3">
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">Question</label>
                                                            <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 text-sm" 
                                                                   placeholder="e.g., What are your visiting hours?" 
                                                                   value="What are your visiting hours?">
                                                        </div>
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">Answer</label>
                                                            <textarea class="w-full border border-gray-300 rounded px-3 py-2 text-sm" rows="2" 
                                                                      placeholder="Provide the answer that the agent should give">Our visiting hours are 10:00 AM to 8:00 PM daily. Emergency patients can be visited 24/7.</textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Add FAQ Block Button -->
                                            <button onclick="addFaqBlock()" class="flex items-center text-blue-600 hover:text-blue-800 border border-dashed border-blue-300 rounded-lg p-3 w-full justify-center">
                                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                                </svg>
                                                Add a new block for FAQs & Guardrails
                                            </button>
                                        </div>

                                        <!-- Advanced Settings -->
                                        <div class="border-t border-gray-200 pt-6">
                                            <h4 class="font-medium text-gray-900 mb-4">Advanced Settings</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Max Tokens</label>
                                                    <input type="number" value="150" min="50" max="4000" 
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Top P</label>
                                                    <input type="number" value="1.0" min="0" max="1" step="0.1" 
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Frequency Penalty</label>
                                                    <input type="number" value="0.0" min="-2" max="2" step="0.1" 
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Presence Penalty</label>
                                                    <input type="number" value="0.0" min="-2" max="2" step="0.1" 
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="transcribeTab" class="tab-content hidden">
                                    <div class="space-y-6">
                                        <h3 class="text-lg font-semibold text-gray-900">Choose Transcriber</h3>
                                        
                                        <!-- Transcriber Selection -->
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Transcriber</label>
                                                <select id="transcriberModel" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                    <option value="deepgram">Deepgram</option>
                                                    <option value="openai-whisper">OpenAI Whisper</option>
                                                    <option value="google-speech">Google Speech-to-Text</option>
                                                    <option value="azure-speech">Azure Speech</option>
                                                    <option value="assembly-ai">AssemblyAI</option>
                                                </select>
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-2">Model</label>
                                                <select id="transcriberVersion" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                    <option value="nova-2">nova-2</option>
                                                    <option value="nova-1">nova-1</option>
                                                    <option value="base">base</option>
                                                    <option value="enhanced">enhanced</option>
                                                    <option value="premium">premium</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- ASR Providers -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">ASR Providers</label>
                                            <div class="border border-gray-300 rounded-lg">
                                                <div class="flex items-center justify-between p-3 border-b border-gray-200">
                                                    <div class="flex items-center">
                                                        <span class="font-medium text-gray-900">Deepgram</span>
                                                        <svg class="w-5 h-5 text-green-500 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                                        </svg>
                                                    </div>
                                                    <button class="text-blue-600 hover:text-blue-800 text-sm">Configure</button>
                                                </div>
                                                <div class="flex items-center justify-between p-3">
                                                    <div class="flex items-center">
                                                        <span class="font-medium text-gray-900">Azure</span>
                                                        <span class="text-gray-400 ml-2 text-sm">(Not configured)</span>
                                                    </div>
                                                    <button class="text-blue-600 hover:text-blue-800 text-sm">Configure</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Keywords/Proper Nouns -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Keywords</label>
                                            <textarea id="keywordsInput" class="w-full border border-gray-300 rounded-lg px-3 py-2" rows="3" 
                                                      placeholder="Bruce:100">Bruce:100</textarea>
                                            <p class="text-sm text-gray-600 mt-1">Enter certain keywords/proper nouns you'd want to boost while understanding speech</p>
                                        </div>

                                        <!-- Generate Precise Transcript -->
                                        <div class="flex items-start space-x-3">
                                            <div class="flex items-center space-x-3 flex-1">
                                                <div>
                                                    <h4 class="font-medium text-gray-900">Generate precise transcript</h4>
                                                    <p class="text-sm text-gray-600">Agent will try to generate more precise transcripts during interruptions</p>
                                                </div>
                                                <a href="#" class="text-blue-600 hover:text-blue-800 text-sm">Learn more ↗</a>
                                            </div>
                                            <label class="relative inline-flex items-center cursor-pointer">
                                                <input type="checkbox" id="preciseTranscript" class="sr-only peer">
                                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                            </label>
                                        </div>

                                        <!-- Number of Words Slider -->
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-2">Number of words to wait for before interrupting</label>
                                            <div class="relative">
                                                <input type="range" id="interruptWordsSlider" min="1" max="10" step="1" value="2" 
                                                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                                    <span>1</span>
                                                    <span id="interruptWordsValue" class="font-medium text-blue-600">2</span>
                                                    <span>10</span>
                                                </div>
                                            </div>
                                            <p class="text-sm text-gray-600 mt-2">
                                                Agent will not consider interruptions until these many words are spoken (If recipient says "Stopwords" such as Stop, Wait, Hold On, agent will pause by default)
                                            </p>
                                        </div>

                                        <!-- Transcription Performance -->
                                        <div class="bg-blue-50 rounded-lg p-4">
                                            <h4 class="font-medium text-blue-900 mb-2">Transcription Performance</h4>
                                            <div class="grid grid-cols-3 gap-4 text-sm">
                                                <div>
                                                    <span class="text-blue-700">Accuracy:</span>
                                                    <span class="font-medium text-blue-900">95.2%</span>
                                                </div>
                                                <div>
                                                    <span class="text-blue-700">Latency:</span>
                                                    <span class="font-medium text-blue-900">~80ms</span>
                                                </div>
                                                <div>
                                                    <span class="text-blue-700">Cost:</span>
                                                    <span class="font-medium text-blue-900">₹0.006/min</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Language Support -->
                                        <div>
                                            <h4 class="font-medium text-gray-900 mb-3">Language Support</h4>
                                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm">Hindi</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm">English</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm">Bengali</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm">Tamil</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm">Telugu</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm">Marathi</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm">Gujarati</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm">Punjabi</span>
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Advanced Transcription Settings -->
                                        <div class="border-t border-gray-200 pt-6">
                                            <h4 class="font-medium text-gray-900 mb-4">Advanced Settings</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                        <span class="text-sm">Enable punctuation</span>
                                                    </label>
                                                </div>
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                        <span class="text-sm">Enable profanity filter</span>
                                                    </label>
                                                </div>
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                        <span class="text-sm">Smart formatting</span>
                                                    </label>
                                                </div>
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                        <span class="text-sm">Speaker diarization</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="voiceTab" class="tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Choose Synthesizer -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Choose Synthesizer</h3>
                                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Provider</label>
                                                    <select id="voiceProvider" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                        <option value="polly">Polly</option>
                                                        <option value="elevenlabs">ElevenLabs</option>
                                                        <option value="openai">OpenAI TTS</option>
                                                        <option value="azure">Azure Cognitive Services</option>
                                                        <option value="custom">Custom Voice</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Style</label>
                                                    <select id="voiceStyle" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                        <option value="neutral">neutral</option>
                                                        <option value="friendly">friendly</option>
                                                        <option value="professional">professional</option>
                                                        <option value="conversational">conversational</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Voice</label>
                                                    <div class="flex items-center">
                                                        <select id="voiceName" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 bg-white mr-2">
                                                            <option value="kajal">Kajal</option>
                                                            <option value="aditi">Aditi</option>
                                                            <option value="ravi">Ravi</option>
                                                            <option value="kendra">Kendra</option>
                                                        </select>
                                                        <button class="flex items-center text-blue-600 hover:text-blue-800 text-sm">
                                                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                                                <path d="M8 5v14l11-7z"/>
                                                            </svg>
                                                            More voices ↗
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Buffer Size -->
                                        <div>
                                            <div class="flex items-center justify-between mb-2">
                                                <h4 class="text-lg font-semibold text-gray-900">Buffer Size</h4>
                                                <span id="bufferSizeValue" class="text-lg font-medium text-gray-900">179</span>
                                            </div>
                                            <input type="range" id="bufferSizeSlider" min="50" max="500" step="1" value="179" 
                                                   class="w-full h-2 bg-blue-500 rounded-lg appearance-none cursor-pointer slider">
                                            <p class="text-sm text-gray-600 mt-2">
                                                Increasing buffer size enables agent to speak long responses fluently, but increases latency
                                            </p>
                                        </div>

                                        <!-- Response Rate and Timing Controls -->
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                            <!-- Response Rate -->
                                            <div>
                                                <h4 class="text-lg font-semibold text-gray-900 mb-3">Response Rate</h4>
                                                <select id="responseRate" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                    <option value="custom">Custom</option>
                                                    <option value="fast">Fast</option>
                                                    <option value="normal">Normal</option>
                                                    <option value="slow">Slow</option>
                                                </select>
                                            </div>

                                            <!-- Endpointing -->
                                            <div>
                                                <div class="flex items-center justify-between mb-2">
                                                    <h4 class="text-lg font-semibold text-gray-900">Endpointing (in ms)</h4>
                                                    <span id="endpointingValue" class="text-lg font-medium text-gray-900">500</span>
                                                </div>
                                                <input type="range" id="endpointingSlider" min="200" max="1000" step="50" value="500" 
                                                       class="w-full h-2 bg-blue-500 rounded-lg appearance-none cursor-pointer slider">
                                                <p class="text-sm text-gray-600 mt-2">
                                                    Number of milliseconds your agent will wait before generating response.
                                                </p>
                                            </div>

                                            <!-- Linear Delay -->
                                            <div>
                                                <div class="flex items-center justify-between mb-2">
                                                    <h4 class="text-lg font-semibold text-gray-900">Linear delay (in ms)</h4>
                                                    <span id="linearDelayValue" class="text-lg font-medium text-gray-900">1200</span>
                                                </div>
                                                <input type="range" id="linearDelaySlider" min="500" max="2000" step="100" value="1200" 
                                                       class="w-full h-2 bg-blue-500 rounded-lg appearance-none cursor-pointer slider">
                                                <p class="text-sm text-gray-600 mt-2">
                                                    Linear delay accounts for long pauses mid-sentence.
                                                </p>
                                            </div>
                                        </div>

                                        <!-- Check if user is online -->
                                        <div>
                                            <div class="flex items-start justify-between mb-4">
                                                <div class="flex-1">
                                                    <h4 class="text-lg font-semibold text-gray-900">Check if user is online</h4>
                                                    <p class="text-sm text-gray-600">
                                                        Agent will check if the user is online if there's no reply from the user
                                                    </p>
                                                </div>
                                                <label class="relative inline-flex items-center cursor-pointer ml-4">
                                                    <input type="checkbox" id="checkUserOnline" checked class="sr-only peer">
                                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                </label>
                                            </div>

                                            <!-- User is online message and timing -->
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">User is online message</label>
                                                    <textarea id="userOnlineMessage" class="w-full border border-gray-300 rounded-lg px-3 py-2" rows="3" 
                                                              placeholder="Hey, are you still there">Hey, are you still there</textarea>
                                                </div>
                                                <div>
                                                    <div class="flex items-center justify-between mb-2">
                                                        <label class="text-sm font-medium text-gray-700">Invoke message after (seconds)</label>
                                                        <span id="invokeMessageValue" class="text-sm font-medium text-blue-600">10</span>
                                                    </div>
                                                    <input type="range" id="invokeMessageSlider" min="5" max="30" step="1" value="10" 
                                                           class="w-full h-2 bg-blue-500 rounded-lg appearance-none cursor-pointer slider">
                                                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                                                        <span>5</span>
                                                        <span>30</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Voice Performance Metrics -->
                                        <div class="bg-blue-50 rounded-lg p-4">
                                            <h4 class="font-medium text-blue-900 mb-3">Voice Performance</h4>
                                            <div class="grid grid-cols-3 gap-4 text-sm">
                                                <div>
                                                    <span class="text-blue-700">Latency:</span>
                                                    <span class="font-medium text-blue-900">~120ms</span>
                                                </div>
                                                <div>
                                                    <span class="text-blue-700">Quality:</span>
                                                    <span class="font-medium text-blue-900">High</span>
                                                </div>
                                                <div>
                                                    <span class="text-blue-700">Cost:</span>
                                                    <span class="font-medium text-blue-900">₹0.15/min</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="callTab" class="tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Telephony Provider -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Telephony Provider</h3>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <select id="telephonyProvider" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                        <option value="plivo">Plivo</option>
                                                        <option value="twilio">Twilio</option>
                                                        <option value="telnyx">Telnyx</option>
                                                        <option value="vonage">Vonage</option>
                                                    </select>
                                                </div>
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <h4 class="font-medium text-gray-900">Voicemail detection</h4>
                                                        <p class="text-sm text-gray-600">Automatically disconnect call on voicemail detection</p>
                                                    </div>
                                                    <label class="relative inline-flex items-center cursor-pointer">
                                                        <input type="checkbox" id="voicemailDetection" class="sr-only peer">
                                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Calling Number Configuration -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Calling Number</h3>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label for="callingNumber" class="block text-sm font-medium text-gray-700 mb-2">
                                                        Phone Number for Outbound Calls
                                                    </label>
                                                    <input 
                                                        type="tel" 
                                                        id="callingNumber" 
                                                        name="callingNumber"
                                                        class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                                        placeholder="+1234567890"
                                                        pattern="^\+[1-9]\d{1,14}$"
                                                        title="Please enter a valid phone number with country code (e.g., +1234567890)"
                                                    />
                                                    <p class="text-xs text-gray-500 mt-1">Enter the phone number this agent will use for outbound calls. Include country code (e.g., +918035743222)</p>
                                                </div>
                                                <div class="flex items-center justify-between">
                                                    <div>
                                                        <h4 class="font-medium text-gray-900">Use Default Number</h4>
                                                        <p class="text-sm text-gray-600">Use the default calling number if none is specified</p>
                                                    </div>
                                                    <label class="relative inline-flex items-center cursor-pointer">
                                                        <input type="checkbox" id="useDefaultNumber" class="sr-only peer" checked>
                                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Call hangup modes -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Call hangup modes</h3>
                                            
                                            <!-- Hangup calls on user silence -->
                                            <div class="space-y-4">
                                                <div class="flex items-start justify-between">
                                                    <div class="flex-1">
                                                        <h4 class="font-medium text-gray-900">Hangup calls on user silence</h4>
                                                        <p class="text-sm text-gray-600">Call will hangup if the user is not speaking</p>
                                                    </div>
                                                    <label class="relative inline-flex items-center cursor-pointer ml-4">
                                                        <input type="checkbox" id="hangupOnSilence" checked class="sr-only peer">
                                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                    </label>
                                                </div>

                                                <!-- Time slider for silence -->
                                                <div class="ml-0">
                                                    <div class="flex items-center justify-between mb-2">
                                                        <label class="text-sm font-medium text-gray-700">Time (seconds)</label>
                                                        <span id="silenceTimeValue" class="text-sm font-medium text-blue-600">10</span>
                                                    </div>
                                                    <input type="range" id="silenceTimeSlider" min="5" max="30" step="1" value="10" 
                                                           class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider">
                                                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                                                        <span>5</span>
                                                        <span>30</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Hangup calls using a prompt -->
                                            <div class="mt-6 space-y-4">
                                                <div class="flex items-start justify-between">
                                                    <div class="flex-1">
                                                        <div class="flex items-center">
                                                            <h4 class="font-medium text-gray-900">Hangup calls using a prompt</h4>
                                                            <a href="#" class="text-blue-600 hover:text-blue-800 text-sm ml-2">See examples ↗</a>
                                                        </div>
                                                        <p class="text-sm text-gray-600">Call will hangup as per the provided prompt</p>
                                                    </div>
                                                    <label class="relative inline-flex items-center cursor-pointer ml-4">
                                                        <input type="checkbox" id="hangupUsingPrompt" class="sr-only peer">
                                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                    </label>
                                                </div>

                                                <!-- Prompt textarea -->
                                                <div class="ml-0">
                                                    <textarea id="hangupPrompt" class="w-full border border-gray-300 rounded-lg px-3 py-2" rows="4" 
                                                              placeholder="You are an AI assistant determining if a conversation is complete. A conversation is complete if:

1. The caller explicitly says they want to end the call
2. All their questions have been answered satisfactorily
3. The purpose of the call has been fulfilled">You are an AI assistant determining if a conversation is complete. A conversation is complete if:

1. The caller explicitly says they want to end the call
2. All their questions have been answered satisfactorily  
3. The purpose of the call has been fulfilled</textarea>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Call hangup message -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Call hangup message</h3>
                                            <textarea id="hangupMessage" class="w-full border border-gray-300 rounded-lg px-3 py-2" rows="2" 
                                                      placeholder="Call will now disconnect">Call will now disconnect</textarea>
                                            <p class="text-sm text-gray-600 mt-2">Provide the final agent message just before hanging up.</p>
                                        </div>

                                        <!-- Call Termination -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Call Termination</h3>
                                            <div class="bg-gray-50 rounded-lg p-4">
                                                <div class="flex items-center justify-between mb-4">
                                                    <span class="text-sm font-medium text-gray-700">The call ends after <span id="terminationTimeDisplay" class="font-semibold">300</span> seconds of call time</span>
                                                    <span class="text-sm text-gray-500">⚙</span>
                                                </div>
                                                
                                                <div class="space-y-2">
                                                    <div class="flex items-center justify-between">
                                                        <label class="text-sm font-medium text-gray-700">Time (seconds)</label>
                                                        <span id="terminationTimeValue" class="text-sm font-medium text-blue-600">300</span>
                                                    </div>
                                                    <input type="range" id="terminationTimeSlider" min="60" max="600" step="30" value="300" 
                                                           class="w-full h-2 bg-blue-500 rounded-lg appearance-none cursor-pointer">
                                                    <div class="flex justify-between text-xs text-gray-500">
                                                        <span>60</span>
                                                        <span>600</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Additional Call Settings -->
                                        <div class="bg-blue-50 rounded-lg p-4">
                                            <h4 class="font-medium text-blue-900 mb-3">Advanced Call Settings</h4>
                                            <div class="space-y-3">
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-3 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Record calls for quality assurance</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-3 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Enable call transfer to human agent</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-3 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Send call summary via SMS</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="toolsTab" class="tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Function Tools Header -->
                                        <div>
                                            <div class="flex items-center justify-between mb-2">
                                                <h3 class="text-lg font-semibold text-gray-900">Function Tools for LLM Models</h3>
                                                <a href="#" class="text-blue-600 hover:text-blue-800 text-sm">See examples and learn more ↗</a>
                                            </div>
                                            <p class="text-sm text-gray-600 mb-4">
                                                Connect external tools or APIs that your language model can call during conversations.
                                                This allows the LLM to retrieve real-time data, perform calculations, or trigger actions dynamically.
                                            </p>
                                        </div>

                                        <!-- Choose functions -->
                                        <div>
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4">Choose functions</h4>
                                            <div class="flex items-center justify-between mb-4">
                                                <select id="functionSelector" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 bg-white mr-4">
                                                    <option value="">Select functions</option>
                                                    <option value="cal_availability">Check slot availability (using Cal.com)</option>
                                                    <option value="cal_booking">Book appointments (using Cal.com)</option>
                                                    <option value="human_transfer">Transfer call to a human agent</option>
                                                    <option value="custom">Add your own custom function</option>
                                                </select>
                                                <button id="addFunctionBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                                    Add function
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Choose functions list -->
                                        <div>
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4">Choose functions</h4>
                                            <div class="space-y-3">
                                                <!-- Function: Check slot availability -->
                                                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white">
                                                    <div class="flex items-center">
                                                        <div class="w-2 h-2 bg-blue-600 rounded-full mr-3"></div>
                                                        <span class="text-gray-900">Check slot availability (using Cal.com)</span>
                                                    </div>
                                                    <button class="text-red-600 hover:text-red-800 text-sm">Remove</button>
                                                </div>

                                                <!-- Function: Book appointments -->
                                                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white">
                                                    <div class="flex items-center">
                                                        <div class="w-2 h-2 bg-blue-600 rounded-full mr-3"></div>
                                                        <span class="text-gray-900">Book appointments (using Cal.com)</span>
                                                    </div>
                                                    <button class="text-red-600 hover:text-red-800 text-sm">Remove</button>
                                                </div>

                                                <!-- Function: Transfer call -->
                                                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white">
                                                    <div class="flex items-center">
                                                        <div class="w-2 h-2 bg-blue-600 rounded-full mr-3"></div>
                                                        <span class="text-gray-900">Transfer call to a human agent</span>
                                                    </div>
                                                    <button class="text-red-600 hover:text-red-800 text-sm">Remove</button>
                                                </div>

                                                <!-- Function: Custom function -->
                                                <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg bg-white">
                                                    <div class="flex items-center">
                                                        <div class="w-2 h-2 bg-blue-600 rounded-full mr-3"></div>
                                                        <span class="text-gray-900">Add your own custom function</span>
                                                    </div>
                                                    <button class="text-red-600 hover:text-red-800 text-sm">Remove</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Function Configuration -->
                                        <div id="functionConfig" class="hidden">
                                            <h4 class="text-lg font-semibold text-gray-900 mb-4">Function Configuration</h4>
                                            <div class="space-y-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Function Name</label>
                                                    <input type="text" id="functionName" class="w-full border border-gray-300 rounded-lg px-3 py-2" 
                                                           placeholder="e.g., checkAvailability">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                                    <textarea id="functionDescription" class="w-full border border-gray-300 rounded-lg px-3 py-2" rows="3" 
                                                              placeholder="Describe what this function does..."></textarea>
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">API Endpoint</label>
                                                    <input type="url" id="functionEndpoint" class="w-full border border-gray-300 rounded-lg px-3 py-2" 
                                                           placeholder="https://api.example.com/endpoint">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Parameters (JSON Schema)</label>
                                                    <textarea id="functionParameters" class="w-full border border-gray-300 rounded-lg px-3 py-2 font-mono text-sm" rows="6" 
                                                              placeholder='{\n  "type": "object",\n  "properties": {\n    "date": {\n      "type": "string",\n      "description": "Date in YYYY-MM-DD format"\n    }\n  },\n  "required": ["date"]\n}'></textarea>
                                                </div>
                                                <div class="flex justify-end space-x-3">
                                                    <button class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                                                        Cancel
                                                    </button>
                                                    <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                                        Save Function
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Integration Settings -->
                                        <div class="bg-gray-50 rounded-lg p-4">
                                            <h4 class="font-medium text-gray-900 mb-3">Integration Settings</h4>
                                            <div class="space-y-3">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Cal.com API Key</label>
                                                    <input type="password" class="w-full border border-gray-300 rounded-lg px-3 py-2" 
                                                           placeholder="Enter your Cal.com API key">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Human Transfer Phone Number</label>
                                                    <input type="tel" class="w-full border border-gray-300 rounded-lg px-3 py-2" 
                                                           placeholder="+1 (555) 123-4567">
                                                </div>
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                        <span class="text-sm text-gray-700">Enable function call logging</span>
                                                    </label>
                                                </div>
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                        <span class="text-sm text-gray-700">Require confirmation before executing functions</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Function Testing -->
                                        <div class="border border-gray-200 rounded-lg p-4">
                                            <h4 class="font-medium text-gray-900 mb-3">Test Functions</h4>
                                            <p class="text-sm text-gray-600 mb-3">
                                                Test your functions to ensure they work correctly before deploying your agent.
                                            </p>
                                            <div class="flex space-x-3">
                                                <button class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                                    Test All Functions
                                                </button>
                                                <button class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                                                    View Test Results
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="analyticsTab" class="tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Post call tasks -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Post call tasks</h3>
                                            <p class="text-sm text-gray-600 mb-6">
                                                Choose tasks to get executed after the agent conversation is complete
                                            </p>
                                        </div>

                                        <!-- Summarization -->
                                        <div class="flex items-center justify-between p-4 border border-gray-200 rounded-lg">
                                            <div class="flex-1">
                                                <h4 class="font-medium text-gray-900">Summarization</h4>
                                                <p class="text-sm text-gray-600">
                                                    Generate a summary of the conversation automatically.
                                                </p>
                                            </div>
                                            <label class="relative inline-flex items-center cursor-pointer">
                                                <input type="checkbox" id="enableSummarization" class="sr-only peer">
                                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                            </label>
                                        </div>

                                        <!-- Extraction -->
                                        <div class="border border-gray-200 rounded-lg p-4">
                                            <div class="flex items-center justify-between mb-4">
                                                <div class="flex-1">
                                                    <h4 class="font-medium text-gray-900">Extraction</h4>
                                                    <p class="text-sm text-gray-600">
                                                        Extract structured information from the conversation according to a custom prompt provided
                                                    </p>
                                                </div>
                                                <label class="relative inline-flex items-center cursor-pointer">
                                                    <input type="checkbox" id="enableExtraction" class="sr-only peer">
                                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                </label>
                                            </div>

                                            <!-- Extraction fields -->
                                            <div id="extractionFields" class="space-y-4 bg-gray-50 rounded-lg p-4">
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-2">user_name</label>
                                                        <p class="text-xs text-gray-600">Yield the name of the user.</p>
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-2">payment_mode</label>
                                                        <p class="text-xs text-gray-600">If user is paying by cash, yield cash. If user is paying by card, yield card.</p>
                                                    </div>
                                                </div>
                                                
                                                <div>
                                                    <button class="text-blue-600 hover:text-blue-800 text-sm">+ Add extraction field</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Push all execution data to webhook -->
                                        <div class="border border-gray-200 rounded-lg p-4">
                                            <div class="flex items-center justify-between mb-4">
                                                <div class="flex-1">
                                                    <div class="flex items-center">
                                                        <h4 class="font-medium text-gray-900">Push all execution data to webhook</h4>
                                                        <a href="#" class="text-blue-600 hover:text-blue-800 text-sm ml-2">See all events ↗</a>
                                                    </div>
                                                    <p class="text-sm text-gray-600">
                                                        Automatically receive all execution data for this agent using webhook
                                                    </p>
                                                </div>
                                                <label class="relative inline-flex items-center cursor-pointer">
                                                    <input type="checkbox" id="enableWebhook" class="sr-only peer">
                                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                                </label>
                                            </div>

                                            <!-- Webhook URL -->
                                            <div id="webhookConfig" class="space-y-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Your webhook URL</label>
                                                    <input type="url" id="webhookUrl" class="w-full border border-gray-300 rounded-lg px-3 py-2" 
                                                           placeholder="https://your-domain.com/webhook">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Webhook Secret (Optional)</label>
                                                    <input type="password" id="webhookSecret" class="w-full border border-gray-300 rounded-lg px-3 py-2" 
                                                           placeholder="Enter webhook secret for verification">
                                                </div>
                                                <div>
                                                    <h5 class="font-medium text-gray-900 mb-2">Events to send</h5>
                                                    <div class="space-y-2">
                                                        <label class="flex items-center">
                                                            <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                            <span class="text-sm text-gray-700">Call started</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                            <span class="text-sm text-gray-700">Call ended</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                            <span class="text-sm text-gray-700">Conversation summary</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                            <span class="text-sm text-gray-700">Extracted data</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                            <span class="text-sm text-gray-700">Function calls</span>
                                                        </label>
                                                        <label class="flex items-center">
                                                            <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                            <span class="text-sm text-gray-700">Error events</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Analytics Settings -->
                                        <div class="bg-blue-50 rounded-lg p-4">
                                            <h4 class="font-medium text-blue-900 mb-3">Analytics & Reporting</h4>
                                            <div class="space-y-3">
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Track conversation length and duration</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Monitor user satisfaction scores</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Track successful task completions</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Generate weekly performance reports</span>
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Data Retention -->
                                        <div class="border border-gray-200 rounded-lg p-4">
                                            <h4 class="font-medium text-gray-900 mb-3">Data Retention</h4>
                                            <div class="space-y-3">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Conversation Data Retention (days)</label>
                                                    <select class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                        <option value="30">30 days</option>
                                                        <option value="90" selected>90 days</option>
                                                        <option value="180">180 days</option>
                                                        <option value="365">1 year</option>
                                                        <option value="forever">Forever</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label class="flex items-center">
                                                        <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                        <span class="text-sm text-gray-700">Auto-delete personal information after retention period</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div id="inboundTab" class="tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Inbound agent settings header -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Inbound agent settings</h3>
                                            <p class="text-sm text-gray-600">
                                                Tweak your inbound agents and add your call settings for receiving incoming calls.
                                            </p>
                                        </div>

                                        <!-- Database for inbound phone numbers -->
                                        <div class="border-t border-gray-200 pt-6">
                                            <h4 class="text-center text-sm font-medium text-gray-900 mb-6 uppercase tracking-wide">
                                                DATABASE FOR INBOUND PHONE NUMBERS
                                            </h4>
                                            
                                            <!-- Match incoming calls section -->
                                            <div class="mb-6">
                                                <div class="flex items-start justify-between mb-4">
                                                    <div class="flex-1">
                                                        <h4 class="font-medium text-gray-900">Match incoming calls to users and preload their data before the call starts</h4>
                                                    </div>
                                                    <a href="#" class="text-blue-600 hover:text-blue-800 text-sm flex items-center">
                                                        See examples and learn more ↗
                                                    </a>
                                                </div>

                                                <!-- Data source selector -->
                                                <div class="mb-4">
                                                    <div class="relative">
                                                        <select id="dataSourceSelector" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white appearance-none">
                                                            <option value="">Select data source</option>
                                                            <option value="no_database">No database</option>
                                                            <option value="internal_apis">Use your internal APIs</option>
                                                            <option value="csv">Use a CSV</option>
                                                            <option value="google_sheet">Use a public Google Sheet</option>
                                                        </select>
                                                        <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                                            </svg>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!-- Data source dropdown options (shown when clicked) -->
                                                <div id="dataSourceOptions" class="hidden border border-gray-200 rounded-lg bg-white shadow-sm">
                                                    <div class="p-2">
                                                        <div class="py-2 px-3 hover:bg-gray-50 cursor-pointer text-sm" data-value="no_database">No database</div>
                                                        <div class="py-2 px-3 hover:bg-gray-50 cursor-pointer text-sm" data-value="internal_apis">Use your internal APIs</div>
                                                        <div class="py-2 px-3 hover:bg-gray-50 cursor-pointer text-sm" data-value="csv">Use a CSV</div>
                                                        <div class="py-2 px-3 hover:bg-gray-50 cursor-pointer text-sm" data-value="google_sheet">Use a public Google Sheet</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Allow incoming calls section -->
                                            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                                                <h4 class="font-medium text-gray-900 mb-2">Allow incoming phone calls only from the chosen database</h4>
                                                <p class="text-sm text-gray-600 mb-2">
                                                    Only allow incoming calls from the numbers you'll source from above.
                                                </p>
                                                <p class="text-sm text-gray-600">
                                                    All other phone calls will be blocked.
                                                </p>
                                            </div>
                                        </div>

                                        <!-- Spam Prevention Settings -->
                                        <div class="border-t border-gray-200 pt-6">
                                            <h4 class="text-center text-sm font-medium text-gray-900 mb-6 uppercase tracking-wide">
                                                SPAM PREVENTION SETTINGS
                                            </h4>

                                            <!-- Maximum calls allowed per phone number -->
                                            <div class="mb-6">
                                                <div class="flex items-start justify-between mb-3">
                                                    <div class="flex-1">
                                                        <h4 class="font-medium text-gray-900">Maximum calls allowed per Phone Number</h4>
                                                        <p class="text-sm text-gray-600">
                                                            Set the number of times each phone number is allowed to call. Enter -1 to allow unlimited calls.
                                                        </p>
                                                    </div>
                                                    <div class="ml-4">
                                                        <input type="number" id="maxCallsPerNumber" value="-1" 
                                                               class="w-20 border border-gray-300 rounded-lg px-3 py-2 text-center">
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Always-allow list -->
                                            <div class="mb-6">
                                                <h4 class="font-medium text-gray-900 mb-2">Always-allow list (bypass call limits)</h4>
                                                <p class="text-sm text-gray-600 mb-3">
                                                    Add phone numbers here that should never be restricted by the call limits
                                                    (ideal for internal or testing numbers).
                                                </p>
                                                <textarea id="alwaysAllowList" 
                                                          class="w-full border border-gray-300 rounded-lg px-3 py-2" 
                                                          rows="3" 
                                                          placeholder="Add phone numbers to whitelist"></textarea>
                                            </div>
                                        </div>

                                        <!-- Phone Number Configuration -->
                                        <div class="border-t border-gray-200 pt-6">
                                            <h4 class="font-medium text-gray-900 mb-4">Phone Number Configuration</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Primary Inbound Number</label>
                                                    <input type="tel" id="primaryInboundNumber" 
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2" 
                                                           placeholder="+91 98765 43210">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Backup Number</label>
                                                    <input type="tel" id="backupNumber" 
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2" 
                                                           placeholder="+91 98765 43211">
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Business Hours -->
                                        <div>
                                            <h4 class="font-medium text-gray-900 mb-4">Business Hours</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Start Time</label>
                                                    <input type="time" value="09:00" id="businessStartTime"
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">End Time</label>
                                                    <input type="time" value="18:00" id="businessEndTime"
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                                </div>
                                            </div>
                                            <div>
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-gray-700">Enable 24/7 availability</span>
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Advanced Inbound Settings -->
                                        <div class="bg-blue-50 rounded-lg p-4">
                                            <h4 class="font-medium text-blue-900 mb-3">Advanced Inbound Settings</h4>
                                            <div class="space-y-3">
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Enable call recording for inbound calls</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Send SMS notification for missed calls</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Enable voicemail for after-hours calls</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-blue-600 focus:ring-blue-500">
                                                    <span class="text-sm text-blue-800">Forward unhandled calls to human agent</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Outbound Tab Content -->
                                <div id="outboundTab" class="tab-content hidden">
                                    <div class="space-y-6">
                                        <!-- Outbound agent settings header -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Outbound agent settings</h3>
                                            <p class="text-sm text-gray-600">
                                                Configure your outbound calling settings and manage phone numbers for making calls.
                                            </p>
                                        </div>

                                        <!-- Place outbound calls section -->
                                        <div class="border border-gray-200 rounded-lg p-4">
                                            <h4 class="font-medium text-gray-900 mb-4">Place Outbound Calls</h4>
                                            <p class="text-sm text-gray-600 mb-4">
                                                Make test calls or initiate outbound campaigns to your contacts.
                                            </p>
                                            <button id="placeCallBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center">
                                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                                </svg>
                                                Place Outbound Call
                                            </button>
                                        </div>

                                        <!-- Outbound Phone Numbers -->
                                        <div>
                                            <h4 class="font-medium text-gray-900 mb-4">Outbound Phone Numbers</h4>
                                            <div class="space-y-3">
                                                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                                                    <div class="flex items-center">
                                                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                                        <span class="text-gray-900">+91 80357 43222</span>
                                                        <span class="ml-2 text-xs bg-green-100 text-green-800 px-2 py-1 rounded">Active</span>
                                                    </div>
                                                    <button class="text-blue-600 hover:text-blue-800 text-sm">Configure</button>
                                                </div>
                                                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg bg-gray-50">
                                                    <div class="flex items-center">
                                                        <div class="w-2 h-2 bg-gray-400 rounded-full mr-3"></div>
                                                        <span class="text-gray-500">+91 80357 43223</span>
                                                        <span class="ml-2 text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">Inactive</span>
                                                    </div>
                                                    <button class="text-blue-600 hover:text-blue-800 text-sm">Activate</button>
                                                </div>
                                            </div>
                                            <button class="mt-3 text-blue-600 hover:text-blue-800 text-sm">
                                                + Add new outbound number
                                            </button>
                                        </div>

                                        <!-- Call Scheduling -->
                                        <div>
                                            <h4 class="font-medium text-gray-900 mb-4">Call Scheduling</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Preferred Calling Hours</label>
                                                    <div class="grid grid-cols-2 gap-2">
                                                        <input type="time" value="09:00" class="border border-gray-300 rounded-lg px-3 py-2">
                                                        <input type="time" value="17:00" class="border border-gray-300 rounded-lg px-3 py-2">
                                                    </div>
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Time Zone</label>
                                                    <select class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                        <option value="IST">India Standard Time (IST)</option>
                                                        <option value="PST">Pacific Standard Time (PST)</option>
                                                        <option value="EST">Eastern Standard Time (EST)</option>
                                                        <option value="GMT">Greenwich Mean Time (GMT)</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Call Retry Settings -->
                                        <div>
                                            <h4 class="font-medium text-gray-900 mb-4">Call Retry Settings</h4>
                                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Max Retry Attempts</label>
                                                    <input type="number" value="3" min="1" max="10" 
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Retry Interval (minutes)</label>
                                                    <input type="number" value="30" min="5" max="1440" 
                                                           class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-2">Retry on</label>
                                                    <select class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white">
                                                        <option value="no_answer">No Answer</option>
                                                        <option value="busy">Busy</option>
                                                        <option value="failed">Failed</option>
                                                        <option value="all">All</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Campaign Settings -->
                                        <div class="bg-orange-50 rounded-lg p-4">
                                            <h4 class="font-medium text-orange-900 mb-3">Campaign Settings</h4>
                                            <div class="space-y-3">
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-orange-600 focus:ring-orange-500">
                                                    <span class="text-sm text-orange-800">Enable call campaigns</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-orange-600 focus:ring-orange-500">
                                                    <span class="text-sm text-orange-800">Record outbound calls</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" class="mr-2 text-orange-600 focus:ring-orange-500">
                                                    <span class="text-sm text-orange-800">Send follow-up SMS after calls</span>
                                                </label>
                                                <label class="flex items-center">
                                                    <input type="checkbox" checked class="mr-2 text-orange-600 focus:ring-orange-500">
                                                    <span class="text-sm text-orange-800">Respect Do Not Call (DNC) lists</span>
                                                </label>
                                            </div>
                                        </div>

                                        <!-- Contact Management -->
                                        <div>
                                            <h4 class="font-medium text-gray-900 mb-4">Contact Management</h4>
                                            <div class="border border-gray-200 rounded-lg p-4">
                                                <div class="flex items-center justify-between mb-3">
                                                    <span class="text-sm font-medium text-gray-700">Contact Lists</span>
                                                    <button class="text-blue-600 hover:text-blue-800 text-sm">Import Contacts</button>
                                                </div>
                                                <div class="space-y-2">
                                                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded">
                                                        <span class="text-sm text-gray-900">Hospital Patients</span>
                                                        <span class="text-xs text-gray-500">1,234 contacts</span>
                                                    </div>
                                                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded">
                                                        <span class="text-sm text-gray-900">Follow-up Appointments</span>
                                                        <span class="text-xs text-gray-500">567 contacts</span>
                                                    </div>
                                                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded">
                                                        <span class="text-sm text-gray-900">Health Checkup Reminders</span>
                                                        <span class="text-xs text-gray-500">890 contacts</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Panel -->
                    <div class="lg:col-span-1">
                        <div class="bg-white rounded-lg border border-gray-200 p-4">
                            <!-- Action Buttons -->
                            <div class="space-y-3 mb-6">
                                <button onclick="showOutboundCallModal()" class="w-full bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 flex items-center justify-center">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                    </svg>
                                    Get call from agent
                                </button>
                                
                                <button onclick="showInboundSettingsModal()" class="w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200">
                                    Set inbound agent
                                </button>
                                
                                <button onclick="showPhoneNumbersModal()" class="w-full text-center text-blue-600 hover:text-blue-700 text-sm border border-blue-200 rounded-lg py-2 hover:bg-blue-50">
                                    Purchase phone numbers ↗
                                </button>
                            </div>

                            <!-- Call Logs -->
                            <div class="border-t border-gray-200 pt-4">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="font-medium text-gray-900">Recent Calls</h4>
                                    <button onclick="showCallLogsModal()" class="text-blue-600 hover:text-blue-700 text-sm">See all call logs →</button>
                                </div>
                                <div class="space-y-2" id="recentCallsList">
                                    <div class="text-sm text-gray-500">Loading recent calls...</div>
                                </div>
                            </div>

                            <!-- Save Button -->
                            <div class="border-t border-gray-200 pt-4 mt-6">
                                <button onclick="saveAgent()" class="w-full bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 flex items-center justify-center">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path>
                                    </svg>
                                    Save agent
                                </button>
                                <div class="text-xs text-gray-500 mt-2 text-center">Last updated 2 days ago</div>
                            </div>

                            <!-- Testing Section -->
                            <div class="border-t border-gray-200 pt-4 mt-6">
                                <h4 class="font-medium text-gray-900 mb-3">Use chat to test agent & prompts</h4>
                                <button onclick="testChat()" class="w-full bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200 mb-3">
                                    Test your prompt via chat
                                </button>
                                
                                <div class="text-sm text-gray-600 mb-3">
                                    Have a web call with your agent to test & experience it (Beta)
                                </div>
                                
                                <button onclick="startWebCall()" class="w-full bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">
                                    Start web call
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('BhashAI Agent Setup loaded');
            showTab('agent');
        });

        // Tab switching
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab content
            const selectedTab = document.getElementById(tabName + 'Tab');
            if (selectedTab) {
                selectedTab.classList.remove('hidden');
            }
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Agent selection
        function selectAgent(element, agentId) {
            // Remove active class from all agent cards
            document.querySelectorAll('.agent-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active class to selected agent
            element.classList.add('active');
            
            // Update agent title
            const title = element.querySelector('.font-medium').textContent;
            document.getElementById('agentTitle').textContent = title;
            
            // Update agent ID display
            const agentIds = {
                reminder: "004686a4-184a-44f0-a765-c91896153e5a",
                ayushman: "15554373-b8e1-4b00-8c25-c4742dc8e480",
                doctor: "164a85e1-b793-42a9-a2f3-a9e857796782",
                dubai: "164a85e1-b793-42a9-a2f3-a9e857796782"
            };
            
            const currentAgentId = agentIds[agentId] || "Unknown Agent ID";
            document.getElementById('agentId').textContent = currentAgentId;
            
            // Load agent-specific data
            loadAgentData(agentId);
        }

        // Load agent data
        function loadAgentData(agentId) {
            const agentData = {
                reminder: {
                    welcome: "नमस्ते मैं आयुष्मान हॉस्पिटल से Dr. Murli BK का AI सहायक बोल रहा हूँ — आप नगपुर के आयुष्मान हॉस्पिटल में मरीजों के लिए आए थे?",
                    prompt: 'Do not repeat - namaste during conversation. Namaste will be only in welcome message\n\n"अगर आपके पास आधार कार्ड और राशन कार्ड है, तो आयुष्मान कार्ड न होने पर भी ICU, ऑपरेशन, या एडमिशन इलाज़ फ्री मे दे दिया जा सकता है।"'
                },
                ayushman: {
                    welcome: "नमस्ते, मैं आयुष्मान योजना के लिए रजिस्ट्रेशन में आपकी सहायता करूंगा।",
                    prompt: "You are helping with Ayushman Bharat registration. Be helpful and collect necessary information politely."
                },
                doctor: {
                    welcome: "Hello, this is a reminder call for your marketing consultation.",
                    prompt: "You are making reminder calls for doctor appointments. Be professional and courteous."
                }
            };

            // Agent ID mapping
            const agentIds = {
                reminder: "004686a4-184a-44f0-a765-c91896153e5a",
                ayushman: "15554373-b8e1-4b00-8c25-c4742dc8e480",
                doctor: "164a85e1-b793-42a9-a2f3-a9e857796782",
                dubai: "164a85e1-b793-42a9-a2f3-a9e857796782"
            };
            
            const data = agentData[agentId] || agentData.reminder;
            document.getElementById('welcomeMessage').value = data.welcome;
            document.getElementById('agentPrompt').value = data.prompt;
        }

        // Action functions
        function addAgent() {
            const name = prompt('Enter agent name:');
            if (name) {
                alert(`Agent "${name}" will be created. This will open the agent configuration form.`);
            }
        }

        function testCall() {
            alert('Initiating test call with agent. You will receive a call shortly on your registered number.');
        }

        function saveAgent() {
            const welcomeMessage = document.getElementById('welcomeMessage').value;
            const agentPrompt = document.getElementById('agentPrompt').value;
            const callingNumber = document.getElementById('callingNumber').value;
            
            // Validate calling number format if provided
            if (callingNumber) {
                const phoneRegex = /^\+[1-9]\d{1,14}$/;
                if (!phoneRegex.test(callingNumber)) {
                    alert('Please enter a valid phone number with country code (e.g., +918035743222)');
                    return;
                }
            }
            
            if (welcomeMessage && agentPrompt) {
                // Prepare agent data
                const agentData = {
                    welcome_message: welcomeMessage,
                    agent_prompt: agentPrompt,
                    calling_number: callingNumber || null
                };
                
                // Get agent ID from the page
                const agentId = document.getElementById('agentId').textContent;
                
                // Save to API
                fetch(`/api/dev/voice-agents/${agentId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(agentData)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.voice_agent) {
                        alert('Agent configuration saved successfully!');
                    } else {
                        alert('Failed to save agent configuration');
                    }
                })
                .catch(error => {
                    console.error('Error saving agent:', error);
                    alert('Error saving agent configuration');
                });
            } else {
                alert('Please fill in both welcome message and agent prompt.');
            }
        }

        function testChat() {
            alert('Opening chat testing interface for this agent...');
            // In real implementation, this would open a chat modal
        }

        function startWebCall() {
            alert('Starting web call with agent. This will open the voice testing interface.');
            // In real implementation, this would initiate web call
        }

        // Enhanced Button Functionalities
        function showOutboundCallModal() {
            console.log('showOutboundCallModal called');
            const modal = document.createElement('div');
            modal.id = 'outboundCallModal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Place outbound calls</h3>
                        <button onclick="closeModal('outboundCallModal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <p class="text-gray-600 mb-4">Enter phone numbers with country code<br>(for example: +16282774700)</p>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Calling to:</label>
                        <div class="flex">
                            <select class="border border-gray-300 rounded-l-lg px-3 py-2 bg-white">
                                <option value="+91">🇮🇳 +91</option>
                                <option value="+1">🇺🇸 +1</option>
                                <option value="+44">🇬🇧 +44</option>
                                <option value="+86">🇨🇳 +86</option>
                            </select>
                            <input type="tel" id="phoneNumber" placeholder="97306 98890" class="flex-1 border-t border-b border-gray-300 px-3 py-2">
                            <button type="button" onclick="clearSavedRecipientNumber()" class="border border-l-0 border-gray-300 rounded-r-lg px-2 py-2 bg-gray-50 hover:bg-gray-100 text-gray-500 text-xs" title="Clear saved number">
                                ✕
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Your last used number will be saved and auto-filled</p>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Calls can be made using:</label>
                        <select id="senderPhone" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                            <option value="">Loading numbers...</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-1">Uses the agent's configured calling number or default if none set</p>
                    </div>
                    
                    <button onclick="placeOutboundCall()" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                        Place call
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Load agent's calling number
            loadAgentCallingNumbers();
            
            // Load previously saved recipient number
            loadSavedRecipientNumber();
        }

        function saveRecipientNumber(countryCode, phoneNumber) {
            // Save recipient number to localStorage for persistence
            const recipientData = {
                countryCode: countryCode,
                phoneNumber: phoneNumber,
                timestamp: Date.now()
            };
            localStorage.setItem('bhashai_last_recipient', JSON.stringify(recipientData));
            console.log('Saved recipient number:', recipientData);
        }

        function loadSavedRecipientNumber() {
            // Load and populate previously saved recipient number
            try {
                const savedData = localStorage.getItem('bhashai_last_recipient');
                if (savedData) {
                    const recipientData = JSON.parse(savedData);
                    
                    // Check if saved data is not too old (7 days)
                    const weekAgo = Date.now() - (7 * 24 * 60 * 60 * 1000);
                    if (recipientData.timestamp > weekAgo) {
                        // Populate country code dropdown
                        const countrySelect = document.querySelector('#outboundCallModal select');
                        if (countrySelect && recipientData.countryCode) {
                            countrySelect.value = recipientData.countryCode;
                        }
                        
                        // Populate phone number input
                        const phoneInput = document.getElementById('phoneNumber');
                        if (phoneInput && recipientData.phoneNumber) {
                            phoneInput.value = recipientData.phoneNumber;
                            phoneInput.style.backgroundColor = '#f0f9ff'; // Light blue to indicate it's saved
                            phoneInput.title = 'Previously used number (auto-filled)';
                            
                            // Update help text to show it's auto-filled
                            const helpText = document.querySelector('#outboundCallModal .text-xs');
                            if (helpText) {
                                helpText.innerHTML = '📱 Auto-filled from last used number • <span class="text-blue-600">Click ✕ to clear</span>';
                            }
                        }
                        
                        console.log('Loaded saved recipient number:', recipientData);
                    } else {
                        // Clear old data
                        localStorage.removeItem('bhashai_last_recipient');
                    }
                }
            } catch (error) {
                console.error('Error loading saved recipient number:', error);
            }
        }

        function clearSavedRecipientNumber() {
            // Clear saved recipient number from localStorage
            localStorage.removeItem('bhashai_last_recipient');
            const phoneInput = document.getElementById('phoneNumber');
            if (phoneInput) {
                phoneInput.value = '';
                phoneInput.style.backgroundColor = '';
                phoneInput.title = '';
                phoneInput.focus(); // Focus on input for new entry
            }
            
            // Reset help text
            const helpText = document.querySelector('#outboundCallModal .text-xs');
            if (helpText) {
                helpText.innerHTML = 'Your last used number will be saved and auto-filled';
            }
            
            console.log('Cleared saved recipient number');
        }

        function loadAgentCallingNumbers() {
            const agentId = document.getElementById('agentId').textContent;
            const senderSelect = document.getElementById('senderPhone');
            
            // Load agent details to get calling number
            fetch(`/api/dev/voice-agents/${agentId}`)
                .then(response => response.json())
                .then(data => {
                    senderSelect.innerHTML = '';
                    
                    if (data.voice_agent && data.voice_agent.calling_number) {
                        // Use agent's configured calling number
                        const option = document.createElement('option');
                        option.value = data.voice_agent.calling_number;
                        option.textContent = `${data.voice_agent.calling_number} (Agent's Number)`;
                        option.selected = true;
                        senderSelect.appendChild(option);
                    }
                    
                    // Add default numbers as backup options
                    const defaultNumbers = ['+918035743222', '+919876543210'];
                    defaultNumbers.forEach(number => {
                        const option = document.createElement('option');
                        option.value = number;
                        option.textContent = `${number} (Default)`;
                        senderSelect.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error loading agent calling numbers:', error);
                    // Fallback to default numbers
                    senderSelect.innerHTML = `
                        <option value="+918035743222">+918035743222 (Default)</option>
                        <option value="+919876543210">+919876543210 (Default)</option>
                    `;
                });
        }

        function showInboundSettingsModal() {
            console.log('showInboundSettingsModal called');
            const modal = document.createElement('div');
            modal.id = 'inboundSettingsModal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-screen overflow-y-auto">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Inbound agent settings</h3>
                        <button onclick="closeModal('inboundSettingsModal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <p class="text-gray-600 mb-6">Tweak your inbound agents and add your call settings for receiving incoming calls.</p>
                    
                    <div class="space-y-6">
                        <div>
                            <h4 class="font-medium text-gray-900 mb-2">DATABASE FOR INBOUND PHONE NUMBERS</h4>
                            <p class="text-sm text-gray-600 mb-3">Match incoming calls to users and preload their data before the call starts</p>
                            
                            <select id="dataSource" class="w-full border border-gray-300 rounded-lg px-3 py-2 mb-4">
                                <option value="">Select data source</option>
                                <option value="no-database">No database</option>
                                <option value="internal-apis">Use your internal APIs</option>
                                <option value="csv">Use a CSV</option>
                                <option value="google-sheet">Use a public Google Sheet</option>
                            </select>
                            
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <label class="flex items-center">
                                    <input type="checkbox" class="mr-2">
                                    <span class="text-sm">Allow incoming phone calls only from the chosen database</span>
                                </label>
                                <p class="text-xs text-gray-500 mt-1">Only allow incoming calls from the numbers you'll source from above. All other phone calls will be blocked.</p>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-medium text-gray-900 mb-2">SPAM PREVENTION SETTINGS</h4>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Maximum calls allowed per Phone Number</label>
                                <input type="number" value="-1" class="w-24 border border-gray-300 rounded-lg px-3 py-2">
                                <p class="text-xs text-gray-500 mt-1">Set the number of times each phone number is allowed to call. Enter -1 to allow unlimited calls.</p>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Always-allow list (bypass call limits)</label>
                                <textarea placeholder="Add phone numbers to whitelist..." class="w-full border border-gray-300 rounded-lg px-3 py-2 h-20"></textarea>
                                <p class="text-xs text-gray-500 mt-1">Add phone numbers here that should never be restricted by the call limits (ideal for internal or testing numbers).</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-4 mt-6">
                        <button onclick="saveInboundSettings()" class="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                            Save Settings
                        </button>
                        <button onclick="closeModal('inboundSettingsModal')" class="flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200">
                            Cancel
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showPhoneNumbersModal() {
            console.log('showPhoneNumbersModal called');
            const modal = document.createElement('div');
            modal.id = 'phoneNumbersModal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 w-full max-w-4xl mx-4 max-h-screen overflow-y-auto">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Purchase Phone Numbers</h3>
                        <button onclick="closeModal('phoneNumbersModal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Country</label>
                            <select id="countrySelect" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="IN">🇮🇳 India</option>
                                <option value="US">🇺🇸 United States</option>
                                <option value="GB">🇬🇧 United Kingdom</option>
                                <option value="CA">🇨🇦 Canada</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Number Type</label>
                            <select id="numberType" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                                <option value="local">Local</option>
                                <option value="toll-free">Toll-free</option>
                                <option value="mobile">Mobile</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Area Code</label>
                            <input type="text" id="areaCode" placeholder="Optional" class="w-full border border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 mb-6">
                        <h4 class="font-medium text-gray-900 mb-3">Available Numbers</h4>
                        <div class="space-y-2" id="availableNumbers">
                            <div class="flex items-center justify-between p-3 bg-white rounded border">
                                <div>
                                    <div class="font-medium">+91 80357 43222</div>
                                    <div class="text-sm text-gray-500">Local • Mumbai</div>
                                </div>
                                <div class="text-right">
                                    <div class="font-medium">₹299/month</div>
                                    <button class="text-blue-600 hover:text-blue-700 text-sm">Select</button>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-white rounded border">
                                <div>
                                    <div class="font-medium">+91 80357 43223</div>
                                    <div class="text-sm text-gray-500">Local • Mumbai</div>
                                </div>
                                <div class="text-right">
                                    <div class="font-medium">₹299/month</div>
                                    <button class="text-blue-600 hover:text-blue-700 text-sm">Select</button>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-white rounded border">
                                <div>
                                    <div class="font-medium">+91 1800 123 456</div>
                                    <div class="text-sm text-gray-500">Toll-free • National</div>
                                </div>
                                <div class="text-right">
                                    <div class="font-medium">₹899/month</div>
                                    <button class="text-blue-600 hover:text-blue-700 text-sm">Select</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-4">
                        <button onclick="refreshNumbers()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200">
                            🔄 Refresh Numbers
                        </button>
                        <button onclick="closeModal('phoneNumbersModal')" class="flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200">
                            Close
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showCallLogsModal() {
            console.log('showCallLogsModal called');
            const modal = document.createElement('div');
            modal.id = 'callLogsModal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 w-full max-w-6xl mx-4 max-h-screen overflow-y-auto">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Call Logs & Analytics</h3>
                        <button onclick="closeModal('callLogsModal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">127</div>
                            <div class="text-sm text-gray-600">Total Calls</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-green-600">89%</div>
                            <div class="text-sm text-gray-600">Success Rate</div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-yellow-600">3.4m</div>
                            <div class="text-sm text-gray-600">Avg Duration</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-purple-600">₹2,847</div>
                            <div class="text-sm text-gray-600">Total Cost</div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-4 mb-4">
                        <select class="border border-gray-300 rounded-lg px-3 py-2">
                            <option>All Status</option>
                            <option>Completed</option>
                            <option>Failed</option>
                            <option>In Progress</option>
                        </select>
                        <select class="border border-gray-300 rounded-lg px-3 py-2">
                            <option>Last 7 days</option>
                            <option>Last 30 days</option>
                            <option>Last 90 days</option>
                        </select>
                        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                            📊 Export CSV
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse border border-gray-200">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="border border-gray-200 px-4 py-2 text-left">Date/Time</th>
                                    <th class="border border-gray-200 px-4 py-2 text-left">Phone Number</th>
                                    <th class="border border-gray-200 px-4 py-2 text-left">Duration</th>
                                    <th class="border border-gray-200 px-4 py-2 text-left">Status</th>
                                    <th class="border border-gray-200 px-4 py-2 text-left">Cost</th>
                                    <th class="border border-gray-200 px-4 py-2 text-left">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="callLogsTable">
                                <tr>
                                    <td class="border border-gray-200 px-4 py-2">2024-01-15 14:30</td>
                                    <td class="border border-gray-200 px-4 py-2">+91 97306 98890</td>
                                    <td class="border border-gray-200 px-4 py-2">4m 23s</td>
                                    <td class="border border-gray-200 px-4 py-2"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Completed</span></td>
                                    <td class="border border-gray-200 px-4 py-2">₹18.50</td>
                                    <td class="border border-gray-200 px-4 py-2">
                                        <button class="text-blue-600 hover:text-blue-700 text-sm mr-2">🎵 Play</button>
                                        <button class="text-blue-600 hover:text-blue-700 text-sm">📄 Transcript</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-200 px-4 py-2">2024-01-15 13:15</td>
                                    <td class="border border-gray-200 px-4 py-2">+91 98765 43210</td>
                                    <td class="border border-gray-200 px-4 py-2">2m 47s</td>
                                    <td class="border border-gray-200 px-4 py-2"><span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Completed</span></td>
                                    <td class="border border-gray-200 px-4 py-2">₹12.30</td>
                                    <td class="border border-gray-200 px-4 py-2">
                                        <button class="text-blue-600 hover:text-blue-700 text-sm mr-2">🎵 Play</button>
                                        <button class="text-blue-600 hover:text-blue-700 text-sm">📄 Transcript</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="border border-gray-200 px-4 py-2">2024-01-15 12:45</td>
                                    <td class="border border-gray-200 px-4 py-2">+91 87654 32109</td>
                                    <td class="border border-gray-200 px-4 py-2">-</td>
                                    <td class="border border-gray-200 px-4 py-2"><span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs">Failed</span></td>
                                    <td class="border border-gray-200 px-4 py-2">₹0.00</td>
                                    <td class="border border-gray-200 px-4 py-2">
                                        <button class="text-gray-400 text-sm mr-2">🎵 Play</button>
                                        <button class="text-blue-600 hover:text-blue-700 text-sm">📄 Error Log</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Modal utility functions
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.remove();
            }
        }

        function placeOutboundCall() {
            console.log('placeOutboundCall v2.0 - Using new API endpoint');
            const phoneNumber = document.getElementById('phoneNumber').value;
            const senderPhone = document.getElementById('senderPhone').value;
            const countryCode = document.querySelector('#outboundCallModal select').value;
            
            if (!phoneNumber) {
                alert('Please enter a phone number');
                return;
            }
            
            // Combine country code and number
            const fullPhoneNumber = countryCode + phoneNumber.replace(/^0+/, '');
            
            // Save the recipient number for future use
            saveRecipientNumber(countryCode, phoneNumber);
            
            // Show loading state
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Placing call...';
            button.disabled = true;
            
            // Get agent ID from the page
            const agentId = document.getElementById('agentId').textContent;
            
            // Use simplified test endpoint for manual calls
            const callData = {
                recipient_phone: fullPhoneNumber,
                sender_phone: senderPhone,
                agent_id: agentId
            };
            
            // Debug: Log the API call being made
            console.log('Making REAL Bolna API call to /api/manual-call with data:', callData);
            
            // Use production-ready manual call endpoint for real Bolna API calls
            fetch('/api/manual-call', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(callData)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                return response.json();
            })
            .then(data => {
                if (data.success || data.successful_calls > 0) {
                    let message = data.message || `Call initiated successfully to ${fullPhoneNumber}`;
                    if (data.note) {
                        message += `\n\n📝 Note: ${data.note}`;
                    }
                    alert(message);
                    closeModal('outboundCallModal');
                    loadRecentCalls(); // Refresh call logs
                } else {
                    alert(`❌ Failed to place call: ${data.message || 'Unknown error'}`);
                }
            })
            .catch(error => {
                console.error('Error placing call:', error);
                // Show more specific error message
                if (error.message.includes('HTTP')) {
                    alert(`❌ API Error: ${error.message}\n\nThe server returned an error. Please check if the API endpoint is working.`);
                } else if (error.message.includes('Failed to fetch')) {
                    alert(`❌ Network Error: Cannot connect to server\n\nPlease check your internet connection and try again.`);
                } else if (error.message.includes('Unexpected token')) {
                    alert(`❌ Invalid Response: Server returned HTML instead of JSON\n\nThis usually means the API endpoint doesn't exist or there's a server error.`);
                } else {
                    alert(`❌ Error placing call: ${error.message}`);
                }
            })
            .finally(() => {
                // Restore button state
                button.textContent = originalText;
                button.disabled = false;
            });
        }

        function saveInboundSettings() {
            const dataSource = document.getElementById('dataSource').value;
            alert(`Inbound settings saved with data source: ${dataSource || 'None'}`);
            closeModal('inboundSettingsModal');
        }

        function refreshNumbers() {
            alert('Refreshing available phone numbers...');
            // Here you would typically make an API call to refresh the numbers
        }

        function loadRecentCalls() {
            // Simulate loading recent calls
            const recentCallsList = document.getElementById('recentCallsList');
            if (recentCallsList) {
                recentCallsList.innerHTML = `
                    <div class="space-y-2">
                        <div class="flex items-center justify-between text-xs">
                            <div>
                                <div class="font-medium">+91 97306 98890</div>
                                <div class="text-gray-500">4m 23s • Completed</div>
                            </div>
                            <div class="text-gray-500">2h ago</div>
                        </div>
                        <div class="flex items-center justify-between text-xs">
                            <div>
                                <div class="font-medium">+91 98765 43210</div>
                                <div class="text-gray-500">2m 47s • Completed</div>
                            </div>
                            <div class="text-gray-500">3h ago</div>
                        </div>
                        <div class="flex items-center justify-between text-xs">
                            <div>
                                <div class="font-medium">+91 87654 32109</div>
                                <div class="text-red-500">Failed</div>
                            </div>
                            <div class="text-gray-500">4h ago</div>
                        </div>
                    </div>
                `;
            }
        }

        // Load recent calls on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded - Page is ready');
            console.log('Sidebar buttons should be active now');
            setTimeout(loadRecentCalls, 1000);
        });

        // LLM Tab Functions
        function addFaqBlock() {
            const faqBlocks = document.getElementById('faqBlocks');
            const blockCount = faqBlocks.children.length;
            
            const newBlock = document.createElement('div');
            newBlock.className = 'faq-block border border-gray-200 rounded-lg p-4';
            newBlock.innerHTML = `
                <div class="flex items-start justify-between mb-3">
                    <h5 class="font-medium text-gray-900">FAQ Block ${blockCount + 1}</h5>
                    <button onclick="removeFaqBlock(this)" class="text-red-600 hover:text-red-800">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Question</label>
                        <input type="text" class="w-full border border-gray-300 rounded px-3 py-2 text-sm" 
                               placeholder="e.g., What are your services?">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Answer</label>
                        <textarea class="w-full border border-gray-300 rounded px-3 py-2 text-sm" rows="2" 
                                  placeholder="Provide the answer that the agent should give"></textarea>
                    </div>
                </div>
            `;
            
            faqBlocks.appendChild(newBlock);
        }

        function removeFaqBlock(button) {
            const block = button.closest('.faq-block');
            if (block) {
                block.remove();
            }
        }

        // Temperature slider functionality
        document.addEventListener('DOMContentLoaded', function() {
            const temperatureSlider = document.getElementById('temperatureSlider');
            const temperatureValue = document.getElementById('temperatureValue');
            
            if (temperatureSlider && temperatureValue) {
                temperatureSlider.addEventListener('input', function() {
                    temperatureValue.textContent = this.value;
                });
            }
        });

        // Navigation functions for hierarchy
        function goBackToChannel() {
            const urlParams = new URLSearchParams(window.location.search);
            const orgId = urlParams.get('org') || 'main-hospital';
            const channelType = urlParams.get('channel') || 'inbound';
            window.location.href = `/channel-detail.html?org=${orgId}&channel=${channelType}`;
        }

        function goBackToOrg() {
            const urlParams = new URLSearchParams(window.location.search);
            const orgId = urlParams.get('org') || 'main-hospital';
            window.location.href = `/organization-detail.html?org=${orgId}`;
        }

        // Initialize with context from URL parameters
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const orgId = urlParams.get('org');
            const channelType = urlParams.get('channel');
            const agentId = urlParams.get('agent');
            
            // Store context for navigation
            window.currentOrg = orgId;
            window.currentChannel = channelType;
            window.currentAgent = agentId;
            
            // Update breadcrumb navigation
            updateBreadcrumbs(orgId, channelType, agentId);
            
            // Update UI with context if provided
            if (agentId) {
                loadAgentData(agentId);
            }
        });

        function updateBreadcrumbs(orgId, channelType, agentId) {
            const orgNames = {
                'main-hospital': 'Main Hospital',
                'emergency-dept': 'Emergency Department'
            };
            
            const channelNames = {
                'inbound': 'Inbound Calls',
                'outbound': 'Outbound Calls',
                'whatsapp': 'WhatsApp'
            };
            
            const agentNames = {
                'appointment-booking': 'Appointment Booking Agent',
                'general-inquiry': 'General Inquiry Agent',
                'emergency-triage': 'Emergency Triage Agent'
            };
            
            if (orgId && document.getElementById('orgBreadcrumb')) {
                document.getElementById('orgBreadcrumb').textContent = orgNames[orgId] || orgId;
            }
            
            if (channelType && document.getElementById('channelBreadcrumb')) {
                document.getElementById('channelBreadcrumb').textContent = channelNames[channelType] || channelType;
            }
            
            if (agentId && document.getElementById('agentBreadcrumb')) {
                document.getElementById('agentBreadcrumb').textContent = agentNames[agentId] || 'Agent Setup';
            }
        }

        function loadAgentData(agentId) {
            // Load specific agent configuration based on agentId
            const agentData = {
                'appointment-booking': {
                    welcome: "नमस्ते मैं आयुष्मान हॉस्पिटल से Dr. Murli BK का AI सहायक बोल रहा हूँ — आप नगपुर के आयुष्मान हॉस्पिटल में मरीजों के लिए आए थे?",
                    prompt: 'Do not repeat - namaste during conversation. Namaste will be only in welcome message\n\n"अगर आपके पास आधार कार्ड और राशन कार्ड है, तो आयुष्मान कार्ड न होने पर भी ICU, ऑपरेशन, या एडमिशन इलाज़ फ्री मे दे दिया जा सकता है।"'
                },
                'general-inquiry': {
                    welcome: "नमस्ते! मैं आयुष्मान हॉस्पिटल का AI सहायक हूँ। आपकी कैसे मदद कर सकता हूँ?",
                    prompt: 'You are a helpful AI assistant for Ayushman Hospital. Answer general inquiries about hospital services, timings, and directions in Hindi or English.'
                }
            };
            
            const agent = agentData[agentId];
            if (agent) {
                document.getElementById('welcomeMessage').value = agent.welcome;
                document.getElementById('agentPrompt').value = agent.prompt;
            }
        }

        // Initialize slider functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Transcriber tab slider
            const interruptSlider = document.getElementById('interruptWordsSlider');
            const interruptValueDisplay = document.getElementById('interruptWordsValue');
            
            if (interruptSlider && interruptValueDisplay) {
                interruptSlider.addEventListener('input', function() {
                    interruptValueDisplay.textContent = this.value;
                });
            }

            // Call tab sliders
            const silenceSlider = document.getElementById('silenceTimeSlider');
            const silenceValueDisplay = document.getElementById('silenceTimeValue');
            
            if (silenceSlider && silenceValueDisplay) {
                silenceSlider.addEventListener('input', function() {
                    silenceValueDisplay.textContent = this.value;
                });
            }

            const terminationSlider = document.getElementById('terminationTimeSlider');
            const terminationValueDisplay = document.getElementById('terminationTimeValue');
            const terminationDisplayText = document.getElementById('terminationTimeDisplay');
            
            if (terminationSlider && terminationValueDisplay && terminationDisplayText) {
                terminationSlider.addEventListener('input', function() {
                    terminationValueDisplay.textContent = this.value;
                    terminationDisplayText.textContent = this.value;
                });
            }

            // Voice tab sliders
            const bufferSizeSlider = document.getElementById('bufferSizeSlider');
            const bufferSizeValue = document.getElementById('bufferSizeValue');
            
            if (bufferSizeSlider && bufferSizeValue) {
                bufferSizeSlider.addEventListener('input', function() {
                    bufferSizeValue.textContent = this.value;
                });
            }

            const endpointingSlider = document.getElementById('endpointingSlider');
            const endpointingValue = document.getElementById('endpointingValue');
            
            if (endpointingSlider && endpointingValue) {
                endpointingSlider.addEventListener('input', function() {
                    endpointingValue.textContent = this.value;
                });
            }

            const linearDelaySlider = document.getElementById('linearDelaySlider');
            const linearDelayValue = document.getElementById('linearDelayValue');
            
            if (linearDelaySlider && linearDelayValue) {
                linearDelaySlider.addEventListener('input', function() {
                    linearDelayValue.textContent = this.value;
                });
            }

            const invokeMessageSlider = document.getElementById('invokeMessageSlider');
            const invokeMessageValue = document.getElementById('invokeMessageValue');
            
            if (invokeMessageSlider && invokeMessageValue) {
                invokeMessageSlider.addEventListener('input', function() {
                    invokeMessageValue.textContent = this.value;
                });
            }

            // Toggle functionality for hangup prompt
            const hangupPromptToggle = document.getElementById('hangupUsingPrompt');
            const hangupPromptTextarea = document.getElementById('hangupPrompt');
            
            if (hangupPromptToggle && hangupPromptTextarea) {
                function togglePromptTextarea() {
                    if (hangupPromptToggle.checked) {
                        hangupPromptTextarea.style.opacity = '1';
                        hangupPromptTextarea.disabled = false;
                    } else {
                        hangupPromptTextarea.style.opacity = '0.5';
                        hangupPromptTextarea.disabled = true;
                    }
                }
                
                hangupPromptToggle.addEventListener('change', togglePromptTextarea);
                togglePromptTextarea(); // Initialize state
            }

            // Toggle functionality for silence settings
            const silenceToggle = document.getElementById('hangupOnSilence');
            const silenceSettings = silenceSlider?.parentElement;
            
            if (silenceToggle && silenceSettings) {
                function toggleSilenceSettings() {
                    if (silenceToggle.checked) {
                        silenceSettings.style.opacity = '1';
                        silenceSlider.disabled = false;
                    } else {
                        silenceSettings.style.opacity = '0.5';
                        silenceSlider.disabled = true;
                    }
                }
                
                silenceToggle.addEventListener('change', toggleSilenceSettings);
                toggleSilenceSettings(); // Initialize state
            }

            // Voice tab toggle functionality
            const checkUserOnlineToggle = document.getElementById('checkUserOnline');
            const userOnlineMessage = document.getElementById('userOnlineMessage');
            const invokeMessageSettings = invokeMessageSlider?.parentElement?.parentElement;
            
            if (checkUserOnlineToggle && userOnlineMessage && invokeMessageSettings) {
                function toggleUserOnlineSettings() {
                    if (checkUserOnlineToggle.checked) {
                        userOnlineMessage.disabled = false;
                        userOnlineMessage.style.opacity = '1';
                        invokeMessageSettings.style.opacity = '1';
                        invokeMessageSlider.disabled = false;
                    } else {
                        userOnlineMessage.disabled = true;
                        userOnlineMessage.style.opacity = '0.5';
                        invokeMessageSettings.style.opacity = '0.5';
                        invokeMessageSlider.disabled = true;
                    }
                }
                
                checkUserOnlineToggle.addEventListener('change', toggleUserOnlineSettings);
                toggleUserOnlineSettings(); // Initialize state
            }

            // Analytics tab toggle functionality
            const extractionToggle = document.getElementById('enableExtraction');
            const extractionFields = document.getElementById('extractionFields');
            
            if (extractionToggle && extractionFields) {
                function toggleExtractionFields() {
                    if (extractionToggle.checked) {
                        extractionFields.style.display = 'block';
                        extractionFields.style.opacity = '1';
                    } else {
                        extractionFields.style.display = 'none';
                        extractionFields.style.opacity = '0.5';
                    }
                }
                
                extractionToggle.addEventListener('change', toggleExtractionFields);
                toggleExtractionFields(); // Initialize state
            }

            const webhookToggle = document.getElementById('enableWebhook');
            const webhookConfig = document.getElementById('webhookConfig');
            
            if (webhookToggle && webhookConfig) {
                function toggleWebhookConfig() {
                    if (webhookToggle.checked) {
                        webhookConfig.style.display = 'block';
                        webhookConfig.style.opacity = '1';
                    } else {
                        webhookConfig.style.display = 'none';
                        webhookConfig.style.opacity = '0.5';
                    }
                }
                
                webhookToggle.addEventListener('change', toggleWebhookConfig);
                toggleWebhookConfig(); // Initialize state
            }

            // Tools tab functionality
            const functionSelector = document.getElementById('functionSelector');
            const addFunctionBtn = document.getElementById('addFunctionBtn');
            const functionConfig = document.getElementById('functionConfig');
            
            if (addFunctionBtn && functionSelector) {
                addFunctionBtn.addEventListener('click', function() {
                    const selectedValue = functionSelector.value;
                    if (selectedValue === 'custom') {
                        functionConfig.style.display = 'block';
                        functionConfig.classList.remove('hidden');
                    } else if (selectedValue) {
                        // Add function to the list
                        console.log('Adding function:', selectedValue);
                        functionSelector.value = ''; // Reset selector
                    }
                });
            }

            // Function removal functionality
            const removeButtons = document.querySelectorAll('.text-red-600');
            removeButtons.forEach(button => {
                if (button.textContent.trim() === 'Remove') {
                    button.addEventListener('click', function() {
                        const functionItem = this.closest('.flex');
                        if (functionItem && confirm('Are you sure you want to remove this function?')) {
                            functionItem.remove();
                        }
                    });
                }
            });

            // Function configuration save/cancel
            const saveFunctionBtn = document.querySelector('#functionConfig .bg-blue-600');
            const cancelFunctionBtn = document.querySelector('#functionConfig .border-gray-300');
            
            if (saveFunctionBtn) {
                saveFunctionBtn.addEventListener('click', function() {
                    // Save function logic here
                    functionConfig.style.display = 'none';
                    functionConfig.classList.add('hidden');
                });
            }
            
            if (cancelFunctionBtn) {
                cancelFunctionBtn.addEventListener('click', function() {
                    functionConfig.style.display = 'none';
                    functionConfig.classList.add('hidden');
                });
            }

            // Add extraction field functionality
            const addExtractionFieldBtn = document.querySelector('#extractionFields button');
            if (addExtractionFieldBtn) {
                addExtractionFieldBtn.addEventListener('click', function() {
                    const fieldsContainer = this.parentElement.previousElementSibling;
                    const fieldName = prompt('Enter field name:');
                    const fieldDescription = prompt('Enter field description:');
                    
                    if (fieldName && fieldDescription) {
                        const newField = document.createElement('div');
                        newField.innerHTML = `
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">${fieldName}</label>
                                <p class="text-xs text-gray-600">${fieldDescription}</p>
                            </div>
                        `;
                        fieldsContainer.appendChild(newField);
                    }
                });
            }

            // Inbound tab functionality
            const dataSourceSelector = document.getElementById('dataSourceSelector');
            const dataSourceOptions = document.getElementById('dataSourceOptions');
            
            if (dataSourceSelector && dataSourceOptions) {
                dataSourceSelector.addEventListener('click', function() {
                    dataSourceOptions.classList.toggle('hidden');
                });

                // Handle option selection
                const options = dataSourceOptions.querySelectorAll('[data-value]');
                options.forEach(option => {
                    option.addEventListener('click', function() {
                        const value = this.getAttribute('data-value');
                        const text = this.textContent;
                        dataSourceSelector.value = value;
                        dataSourceSelector.innerHTML = `<option value="${value}" selected>${text}</option>`;
                        dataSourceOptions.classList.add('hidden');
                    });
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', function(event) {
                    if (!dataSourceSelector.contains(event.target) && !dataSourceOptions.contains(event.target)) {
                        dataSourceOptions.classList.add('hidden');
                    }
                });
            }

            // Outbound tab functionality - Place Call Modal
            const placeCallBtn = document.getElementById('placeCallBtn');
            const placeCallModal = document.getElementById('placeCallModal');
            const closeModalBtn = document.getElementById('closeModalBtn');
            const placeCallConfirmBtn = document.getElementById('placeCallConfirmBtn');
            
            if (placeCallBtn && placeCallModal) {
                placeCallBtn.addEventListener('click', function() {
                    placeCallModal.classList.remove('hidden');
                });
            }

            if (closeModalBtn && placeCallModal) {
                closeModalBtn.addEventListener('click', function() {
                    placeCallModal.classList.add('hidden');
                });
            }

            if (placeCallConfirmBtn) {
                placeCallConfirmBtn.addEventListener('click', function() {
                    const phoneNumber = document.getElementById('phoneNumberInput').value;
                    const callingNumber = document.getElementById('callingNumber').value;
                    
                    if (phoneNumber && callingNumber) {
                        alert(`Placing call to ${phoneNumber} using ${callingNumber}`);
                        placeCallModal.classList.add('hidden');
                    } else {
                        alert('Please enter a valid phone number');
                    }
                });
            }

            // Close modal when clicking outside
            if (placeCallModal) {
                placeCallModal.addEventListener('click', function(event) {
                    if (event.target === placeCallModal) {
                        placeCallModal.classList.add('hidden');
                    }
                });
            }

            // Country code and phone number synchronization
            const countryCode = document.getElementById('countryCode');
            const phoneNumberInput = document.getElementById('phoneNumberInput');
            
            if (countryCode && phoneNumberInput) {
                countryCode.addEventListener('change', function() {
                    const selectedCode = this.value;
                    const currentNumber = phoneNumberInput.value;
                    
                    // Remove existing country code and add new one
                    const numberWithoutCode = currentNumber.replace(/^\+\d{1,3}\s?/, '');
                    phoneNumberInput.value = `${selectedCode} ${numberWithoutCode}`.trim();
                });
            }
        });
    </script>

    <!-- Place Outbound Calls Modal -->
    <div id="placeCallModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <!-- Modal Header -->
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-900">Place outbound calls</h3>
                <button id="closeModalBtn" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="space-y-4">
                <p class="text-sm text-gray-600">
                    Enter phone numbers with country code<br>
                    (for example: +16282774700)
                </p>

                <!-- Calling to section -->
                <div>
                    <label class="block text-sm font-medium text-gray-900 mb-2">Calling to:</label>
                    <div class="flex space-x-2">
                        <!-- Country Code Dropdown -->
                        <div class="relative">
                            <select id="countryCode" class="border border-gray-300 rounded-lg px-3 py-2 bg-white appearance-none pr-8">
                                <option value="+91" data-flag="🇮🇳">🇮🇳</option>
                                <option value="+1" data-flag="🇺🇸">🇺🇸</option>
                                <option value="+44" data-flag="🇬🇧">🇬🇧</option>
                                <option value="+86" data-flag="🇨🇳">🇨🇳</option>
                                <option value="+81" data-flag="🇯🇵">🇯🇵</option>
                            </select>
                            <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                        </div>

                        <!-- Phone Number Input -->
                        <input type="tel" id="phoneNumberInput" 
                               class="flex-1 border border-gray-300 rounded-lg px-3 py-2" 
                               placeholder="+91 97306 98890"
                               value="+91 97306 98890">
                    </div>
                </div>

                <!-- Calls can be made using section -->
                <div>
                    <label class="block text-sm font-medium text-gray-900 mb-2">Calls can be made using:</label>
                    <div class="relative">
                        <select id="callingNumber" class="w-full border border-gray-300 rounded-lg px-3 py-2 bg-white appearance-none">
                            <option value="+918035743222">+918035743222</option>
                            <option value="+918035743223">+918035743223</option>
                            <option value="+918035743224">+918035743224</option>
                        </select>
                        <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- Place Call Button -->
                <div class="pt-4">
                    <button id="placeCallConfirmBtn" class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium">
                        Place call
                    </button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>